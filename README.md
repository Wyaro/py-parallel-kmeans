# K-Means Benchmark Suite

> –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º–∞ K-means –Ω–∞ CPU –∏ GPU

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#–æ–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)
- [–û–ø–∏—Å–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ K-means](#–æ–ø–∏—Å–∞–Ω–∏–µ-–∞–ª–≥–æ—Ä–∏—Ç–º–∞-k-means)
- [–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞](#–±—ã—Å—Ç—Ä–∞—è-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã](#—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã)
- [–£—Å–ª–æ–≤–∏—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤](#—É—Å–ª–æ–≤–∏—è-–ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è-—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏-–∞–ª–≥–æ—Ä–∏—Ç–º–∞)
- [–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏](#–º–µ—Ç—Ä–∏–∫–∏-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
- [–ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤](#–∞–Ω–∞–ª–∏–∑-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**K-Means Benchmark Suite** ‚Äî —ç—Ç–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ K-means –Ω–∞ CPU –∏ GPU, –≤—ã—è–≤–ª–µ–Ω–∏—è —É–∑–∫–∏—Ö –º–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –≤—ã–±–æ—Ä—É –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏.

### –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

–¶–µ–ª—å—é –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã —è–≤–ª—è–µ—Ç—Å—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ ¬´K-means¬ª –Ω–∞ CPU –∏ GPU, –≤—ã—è–≤–ª–µ–Ω–∏–µ —É–∑–∫–∏—Ö –º–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è, –∞ —Ç–∞–∫–∂–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –≤—ã–±–æ—Ä—É –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏.

### –ó–∞–¥–∞—á–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è

- –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω—É—é, –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—É—é –∏ GPU –≤–µ—Ä—Å–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ K-means
- –ò–∑–º–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–∞ –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö —Ä–∞–∑–ª–∏—á–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∞
- –ü—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º N, D, K
- –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —É—Å–ª–æ–≤–∏—è, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–æ–π –∏–ª–∏ –∏–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º
- –í—ã—è–≤–∏—Ç—å —É–∑–∫–∏–µ –º–µ—Å—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–í–∞–∂–Ω–æ–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –î–∞–Ω–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ—Å–≤—è—â–µ–Ω–æ –∏–º–µ–Ω–Ω–æ –∞–Ω–∞–ª–∏–∑—É –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –∞ –Ω–µ –æ—Ü–µ–Ω–∫–µ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏. –ö–∞—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ª–∏—à—å –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π, –Ω–æ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥–º–µ—Ç–æ–º –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**: CPU (NumPy, multiprocessing), GPU (CuPy/CUDA)
- **5 —Ç–∏–ø–æ–≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤** —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º –∏ —Å–±–æ—Ä–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤** —Å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞**: –∞–ª–≥–æ—Ä–∏—Ç–º –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (–º–∞–∫—Å–∏–º—É–º 100 –∏—Ç–µ—Ä–∞—Ü–∏–π)
- **–ü–æ—Ç–æ–∫–æ–≤–∞—è –∑–∞–ø–∏—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** –≤ —Ñ–æ—Ä–º–∞—Ç–µ NDJSON –ø–æ –º–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–Ω–Ω–∏–π –≤—ã—Ö–æ–¥ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞
- **–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –∞–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ —ç—Ç–∞–ø–∞–º –∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫

---

## –û–ø–∏—Å–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ K-means

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞

–ê–ª–≥–æ—Ä–∏—Ç–º K-means –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ—à–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∑–∞–¥–∞—á—É –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏:

–î–∞–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ **X = {x‚ÇÅ, x‚ÇÇ, ‚Ä¶, x‚Çô}**, –≥–¥–µ **x·µ¢ ‚àà ‚Ñù·¥∞**, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–∑–±–∏—Ç—å –Ω–∞ **K** (–∑–∞–¥–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ) –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ **C‚ÇÅ, ‚Ä¶, C‚Çñ** —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤–Ω—É—Ç—Ä–∏–∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–π —Å—É–º–º—ã –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ (WCSS, Within-Cluster Sum of Squares):

```
J = Œ£(k=1 to K) Œ£(x·µ¢ ‚àà C‚Çñ) ||x·µ¢ - Œº‚Çñ||¬≤
```

–≥–¥–µ **Œº‚Çñ** ‚Äî —Ü–µ–Ω—Ç—Ä–æ–∏–¥ –∫–ª–∞—Å—Ç–µ—Ä–∞ **C‚Çñ**, –≤—ã—á–∏—Å–ª—è–µ–º—ã–π –∫–∞–∫ —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ –≤—Å–µ—Ö —Ç–æ—á–µ–∫, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä—É:

```
Œº‚Çñ = (1/|C‚Çñ|) Œ£(x·µ¢ ‚àà C‚Çñ) x·µ¢
```

### –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –∏—Ç–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º (–º–µ—Ç–æ–¥ –õ–ª–æ–π–¥–∞)

–ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —ç—Ç–∞–ø–æ–≤:

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤**: –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä K –Ω–∞—á–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤ –∏–∑ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
2. **–®–∞–≥ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏—è**: –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É **x·µ¢** –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞ **Œº‚Çñ**, –∏—Å–ø–æ–ª—å–∑—É—è –ï–≤–∫–ª–∏–¥–æ–≤—É –º–µ—Ç—Ä–∏–∫—É:
   ```
   c·µ¢ = argmin‚Çñ ||x·µ¢ - Œº‚Çñ||¬≤
   ```
3. **–®–∞–≥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –ø–µ—Ä–µ—Å—á–µ—Ç —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫
4. **–ö—Ä–∏—Ç–µ—Ä–∏–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏**: —à–∞–≥–∏ 2-3 –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–µ—Ä–∏—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–ª–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏—Ç–µ—Ä–∞—Ü–∏–π

### –í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å

–û–¥–Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏–º–µ–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å:

```
O(N √ó K √ó D)
```

–≥–¥–µ:
- **N** ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫
- **K** ‚Äî —á–∏—Å–ª–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- **D** ‚Äî —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤:

```python
from scripts.generate_datasets import DatasetGenerator

generator = DatasetGenerator(base_seed=42)
generator.generate_all()  # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤—Å–µ —Ç–∏–ø—ã –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
```

### –ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

```bash
# –í—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã (–ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞)
python -m kmeans.main --experiment all

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç
python -m kmeans.main --experiment exp2_scaling_n

# –° –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ (30 –º–∏–Ω—É—Ç)
python -m kmeans.main --experiment exp2_scaling_n --max-seconds 1800

# –¢–æ–ª—å–∫–æ GPU —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å CPU –∞–ª–≥–æ—Ä–∏—Ç–º—ã)
python -m kmeans.main --experiment exp2_scaling_n --gpu-only
```

### –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

```python
from scripts.analyze_timings import compute_stats_from_results

compute_stats_from_results("kmeans_timing_results.json", output_path="timings_report.txt")
```

---

## –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Python**: 3.10 –∏–ª–∏ –≤—ã—à–µ
- **–û–°**: Windows, Linux, macOS
- **GPU** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): NVIDIA GPU —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CUDA –¥–ª—è GPU-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

#### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <repository-url>
cd parallel
```

#### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv .venv
.venv\Scripts\activate
```

**Linux/macOS:**
```bash
python -m venv .venv
source .venv/bin/activate
```

#### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install --upgrade pip
pip install -r requirements.txt
```

#### –®–∞–≥ 4: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –≤–µ—Ä—Å–∏—é CUDA:
```bash
nvidia-smi
# –∏–ª–∏
nvcc --version
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≤–µ—Ä—Å–∏—é CuPy:

**–î–ª—è CUDA 13.x:**
```bash
pip install cupy-cuda13x
```

**–î–ª—è CUDA 12.x:**
```bash
pip install cupy-cuda12x
```

**–î–ª—è CUDA 11.x:**
```bash
pip install cupy-cuda11x
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ï—Å–ª–∏ –≤—ã –Ω–µ —É–≤–µ—Ä–µ–Ω—ã –≤ –≤–µ—Ä—Å–∏–∏ CUDA, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `cupy-cuda12x` - –æ–Ω –æ–±—ã—á–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å –±–æ–ª–µ–µ –Ω–æ–≤—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏ CUDA.

#### –®–∞–≥ 5: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

```bash
python main.py
```

–ò–ª–∏ —Ç–æ–ª—å–∫–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–æ–≤:
```bash
python -c "from generate_datasets import DatasetGenerator; DatasetGenerator(base_seed=42).generate_all()"
```

### –ü–æ–¥—Ä–æ–±–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Python 3.10 –∏–ª–∏ –≤—ã—à–µ:

```bash
python --version
```

–ï—Å–ª–∏ Python –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —Å–∫–∞—á–∞–π—Ç–µ –µ–≥–æ —Å [python.org](https://www.python.org/downloads/).

**–í–∞–∂–Ω–æ**: –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –Ω–∞ Windows —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–±—Ä–∞–Ω–∞ –æ–ø—Ü–∏—è "Add Python to PATH".

#### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏–∑–æ–ª–∏—Ä—É–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ –æ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ Python.

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv .venv

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è (Windows)
.venv\Scripts\activate

# –ê–∫—Ç–∏–≤–∞—Ü–∏—è (Linux/macOS)
source .venv/bin/activate
```

#### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

#### 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–í–ê–ñ–ù–û**: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–æ–ª—å–∫–æ **–û–î–ù–£** —Å–±–æ—Ä–∫—É CuPy, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≤–∞—à–µ–π –≤–µ—Ä—Å–∏–∏ CUDA.

–°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –≤–µ—Ä—Å–∏—é CUDA:

```bash
nvidia-smi
```

–ó–∞—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –≤–µ—Ä—Å–∏—é CuPy:

```bash
# –î–ª—è CUDA 12.x
pip install cupy-cuda12x

# –ò–ª–∏ –¥–ª—è CUDA 11.x
pip install cupy-cuda11x
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏–π CuPy, —ç—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã. –ü–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ —É–¥–∞–ª–∏—Ç–µ –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ:

     ```bash
pip uninstall -y cupy cupy-cuda11x cupy-cuda12x cupy-cuda13x
pip install cupy-cuda12x  # –∏–ª–∏ –Ω—É–∂–Ω–∞—è –≤–∞–º –≤–µ—Ä—Å–∏—è
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ PyCharm

#### –°–ø–æ—Å–æ–± 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ PyCharm
2. –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è "No Python interpreter configured" –Ω–∞–∂–º–∏—Ç–µ **"Configure Python Interpreter"**
3. –í—ã–±–µ—Ä–∏—Ç–µ **"New environment"**
4. –£–∫–∞–∂–∏—Ç–µ Location: `.venv` (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)
5. –í—ã–±–µ—Ä–∏—Ç–µ Base interpreter: Python 3.10 –∏–ª–∏ –≤—ã—à–µ
6. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≥–∞–ª–æ—á–∫–∞ **"Inherit global site-packages"** —Å–Ω—è—Ç–∞
7. –ù–∞–∂–º–∏—Ç–µ **"OK"**
8. PyCharm –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏—Ç `requirements.txt` –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

#### –°–ø–æ—Å–æ–± 2: –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1. **File** ‚Üí **Settings** (Ctrl+Alt+S)
2. **Project: parallel** ‚Üí **Python Interpreter**
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —à–µ—Å—Ç–µ—Ä—ë–Ω–∫—É ‚Üí **"Add..."**
4. –í—ã–±–µ—Ä–∏—Ç–µ **"New environment"**
5. Location: `.venv`, Base interpreter: Python 3.10+
6. –ù–∞–∂–º–∏—Ç–µ **"OK"**
7. –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ PyCharm –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

   ```bash
   pip install -r requirements.txt
   ```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

#### –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑–æ–≤—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
import numpy as np
import sklearn
import matplotlib.pyplot as plt

print(f"NumPy –≤–µ—Ä—Å–∏—è: {np.__version__}")
print(f"SciKit-learn –≤–µ—Ä—Å–∏—è: {sklearn.__version__}")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
from kmeans.core.cpu_numpy import KMeansCPUNumpy
from kmeans.core.gpu_numpy import gpu_available

print(f"GPU –¥–æ—Å—Ç—É–ø–µ–Ω: {gpu_available()}")
```

#### –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `check_installation.py`:

```python
"""–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ K-Means Benchmark Suite."""

import sys

def check_python_version():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ Python."""
    version = sys.version_info
    if version.major >= 3 and version.minor >= 10:
        print(f"‚úì Python {version.major}.{version.minor}.{version.micro}")
        return True
    else:
        print(f"‚úó Python {version.major}.{version.minor}.{version.micro} (—Ç—Ä–µ–±—É–µ—Ç—Å—è 3.10+)")
        return False

def check_dependencies():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π."""
    dependencies = {
        "numpy": "NumPy",
        "scipy": "SciPy",
        "sklearn": "SciKit-learn",
        "matplotlib": "Matplotlib",
    }
    
    all_ok = True
    for module, name in dependencies.items():
        try:
            mod = __import__(module)
            version = getattr(mod, "__version__", "unknown")
            print(f"‚úì {name}: {version}")
        except ImportError:
            print(f"‚úó {name}: –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
            all_ok = False
    
    return all_ok

def check_gpu():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∏."""
    try:
        from kmeans.core.gpu_numpy import gpu_available
        if gpu_available():
            import cupy as cp
            print(f"‚úì GPU –¥–æ—Å—Ç—É–ø–µ–Ω (CuPy {cp.__version__})")
            return True
        else:
            print("‚ö† GPU –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)")
            return True  # –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
    except ImportError:
        print("‚ö† GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)")
        return True  # –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ

def check_project_modules():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥—É–ª–µ–π –ø—Ä–æ–µ–∫—Ç–∞."""
    modules = [
        "kmeans.core.cpu_numpy",
        "kmeans.core.cpu_multiprocessing",
        "kmeans.data.dataset",
        "kmeans.experiments.suite",
    ]
    
    all_ok = True
    for module in modules:
        try:
            __import__(module)
            print(f"‚úì {module}")
        except ImportError as e:
            print(f"‚úó {module}: {e}")
            all_ok = False
    
    return all_ok

if __name__ == "__main__":
    print("–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ K-Means Benchmark Suite\n")
    print("=" * 50)
    
    checks = [
        ("–í–µ—Ä—Å–∏—è Python", check_python_version),
        ("–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏", check_dependencies),
        ("–ú–æ–¥—É–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞", check_project_modules),
        ("GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∞", check_gpu),
    ]
    
    results = []
    for name, check_func in checks:
        print(f"\n{name}:")
        results.append(check_func())
    
    print("\n" + "=" * 50)
    if all(results[:3]):  # –ü–µ—Ä–≤—ã–µ 3 –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã
        print("‚úì –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —É—Å–ø–µ—à–Ω–∞!")
    else:
        print("‚úó –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏ –≤—ã—à–µ.")
        sys.exit(1)
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É:
```bash
python check_installation.py
```

### –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

#### –ü—Ä–æ–±–ª–µ–º–∞: Python –Ω–µ –Ω–∞–π–¥–µ–Ω

**–°–∏–º–ø—Ç–æ–º—ã**: `python: command not found` –∏–ª–∏ `'python' is not recognized`

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Python —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: `python --version`
2. –ù–∞ Windows –¥–æ–±–∞–≤—å—Ç–µ Python –≤ PATH
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `python3` –≤–º–µ—Å—Ç–æ `python` (Linux/macOS)

#### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–°–∏–º–ø—Ç–æ–º—ã**: `ERROR: Could not find a version that satisfies the requirement`

**–†–µ—à–µ–Ω–∏–µ**:
1. –û–±–Ω–æ–≤–∏—Ç–µ pip: `python -m pip install --upgrade pip`
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–æ –æ–¥–Ω–æ–π –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
   ```bash
   pip install numpy
   pip install scipy
   pip install scikit-learn
   pip install matplotlib
   ```
3. –ù–∞ Windows –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Visual C++ Build Tools

#### –ü—Ä–æ–±–ª–µ–º–∞: CuPy –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã**: –û—à–∏–±–∫–∏ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ `cupy-cuda*`

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ CUDA Toolkit —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é CUDA: `nvidia-smi` –∏–ª–∏ `nvcc --version`
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é CuPy –¥–ª—è –≤–∞—à–µ–π CUDA
4. GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ - –ø—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –±–µ–∑ –Ω–µ—ë

#### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –∏–º–ø–æ—Ä—Ç–∞ –º–æ–¥—É–ª–µ–π –ø—Ä–æ–µ–∫—Ç–∞

**–°–∏–º–ø—Ç–æ–º—ã**: `ModuleNotFoundError: No module named 'kmeans'`

**–†–µ—à–µ–Ω–∏–µ**:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install -r requirements.txt`

#### –ü—Ä–æ–±–ª–µ–º–∞: PyCharm –Ω–µ –≤–∏–¥–∏—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ**:
1. File ‚Üí Settings ‚Üí Project: parallel ‚Üí Python Interpreter
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —à–µ—Å—Ç–µ—Ä—ë–Ω–∫—É ‚Üí "Add..."
3. –í—ã–±–µ—Ä–∏—Ç–µ "Existing environment"
4. –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ `python.exe` –≤ `.venv\Scripts\python.exe` (Windows)

#### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

**–°–∏–º–ø—Ç–æ–º—ã**: `MemoryError` –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

**–†–µ—à–µ–Ω–∏–µ**:
1. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
2. –î–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö N (>10M) –¥–∞—Ç–∞—Å–µ—Ç –±—É–¥–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ 5M —Ç–æ—á–µ–∫
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–≤–æ–±–æ–¥–Ω–æ–π RAM

#### –ü—Ä–æ–±–ª–µ–º–∞: GPU –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ CuPy

**–°–∏–º–ø—Ç–æ–º—ã**: `gpu_available()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `False`

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ GPU –≤–∏–¥–Ω–∞ —Å–∏—Å—Ç–µ–º–æ–π: `nvidia-smi`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è CuPy
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å CUDA –∏ CuPy –≤–µ—Ä—Å–∏–π
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Python –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ CuPy

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ conda

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
conda create -n kmeans-benchmark python=3.10
conda activate kmeans-benchmark

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
conda install numpy scipy scikit-learn matplotlib
pip install -r requirements.txt  # –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

# –î–ª—è GPU (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
conda install -c conda-forge cupy
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ `.venv` —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ `.gitignore` –∏ –Ω–µ –±—É–¥–µ—Ç –∫–æ–º–º–∏—Ç–∏—Ç—å—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π. –ö–∞–∂–¥—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–∑–¥–∞—ë—Ç —Å–≤–æ—ë –ª–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ.

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

```bash
python main.py
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç:
- –ë–∞–∑–æ–≤—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
- –î–∞—Ç–∞—Å–µ—Ç—ã –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ N, D, K
- –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤

### –®–∞–≥ 2: –ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

```bash
# –í—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞)
python -m kmeans.main --experiment all

# –ò–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç
python -m kmeans.main --experiment exp1_baseline_single
python -m kmeans.main --experiment exp2_scaling_n
python -m kmeans.main --experiment exp3_scaling_d
python -m kmeans.main --experiment exp4_scaling_k
python -m kmeans.main --experiment exp5_gpu_profile
```

### –®–∞–≥ 3: –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
python scripts/analyze_timings.py
# –ò–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ:
python -c "from scripts.analyze_timings import compute_stats_from_results; compute_stats_from_results('kmeans_timing_results.json', output_path='timings_report.txt')"
```

---

## üî¨ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç **5 —Ç–∏–ø–æ–≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤** –¥–ª—è –≤—Å–µ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

### –û–±—â–∏–µ –æ–ø—Ü–∏–∏ –∑–∞–ø—É—Å–∫–∞

```bash
# –í—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
python -m kmeans.main --experiment all

# –° –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ (30 –º–∏–Ω—É—Ç)
python -m kmeans.main --experiment all --max-seconds 1800

# –¢–æ–ª—å–∫–æ GPU —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å CPU –∞–ª–≥–æ—Ä–∏—Ç–º—ã)
python -m kmeans.main --experiment all --gpu-only
```

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 1: –ò–∑–º–µ—Ä–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π

**–¶–µ–ª—å**: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–∑–æ–≤–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| N | 100,000 |
| D | 50 |
| K | 8 |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ | `python_cpu_numpy` |
| –ú–µ—Ç—Ä–∏–∫–∏ | T_–Ω–∞–∑–Ω, T_–æ–±–Ω, T_–∏—Ç–µ—Ä, T_–æ–±—â |
| –ü–æ–≤—Ç–æ—Ä—ã | 30 |
| Warmup | 3 |

**–ó–∞–ø—É—Å–∫**:
```bash
python -m kmeans.main --experiment exp1_baseline_single
```

**–û–ø–∏—Å–∞–Ω–∏–µ**: –≠—Ç–æ—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç —Å–ª—É–∂–∏—Ç –±–∞–∑–æ–≤–æ–π –ª–∏–Ω–∏–µ–π –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –º–µ—Ç—Ä–∏–∫ —É—Å–∫–æ—Ä–µ–Ω–∏—è (Speedup) –∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (Efficiency) –≤ –¥—Ä—É–≥–∏—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö.

---

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 2: –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ç–æ—á–µ–∫ (N)

**–¶–µ–ª—å**: –û—Ü–µ–Ω–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏—è |
|----------|----------|
| N | {10¬≥, 10‚Åµ, 10‚Å∂, 5√ó10‚Å∂} |
| D | 50 (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ) |
| K | 8 (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ) |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ | CPU (single, multi-process), GPU (–≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã) |
| –ü–æ–≤—Ç–æ—Ä—ã | 50, 20, 10, 5 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ |

**–ó–∞–ø—É—Å–∫**:
```bash
python -m kmeans.main --experiment exp2_scaling_n
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –î–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ (N ‚â• 1,000,000) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ GPU-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞–º—è—Ç–∏
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∫–ª—é—á–∞—é—Ç –º–µ—Ç—Ä–∏–∫–∏ —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ baseline

---

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 3: –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ (D)

**–¶–µ–ª—å**: –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏—è |
|----------|----------|
| D | {2, 10, 50, 100, 200} |
| N | 100,000 (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ) |
| K | 8 (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ) |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ | CPU (single, multi-process), GPU (–≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã) |
| –ü–æ–≤—Ç–æ—Ä—ã | 20, 20, 10, 10, 10 |

**–ó–∞–ø—É—Å–∫**:
```bash
python -m kmeans.main --experiment exp3_scaling_d
```

---

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 4: –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (K)

**–¶–µ–ª—å**: –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –≤–ª–∏—è–Ω–∏–µ —á–∏—Å–ª–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –Ω–∞ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏—è |
|----------|----------|
| K | {4, 8, 16, 32} |
| N | 100,000 (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ) |
| D | 50 (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ) |
| –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ | CPU (single, multi-process), GPU (–≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã) |
| –ü–æ–≤—Ç–æ—Ä—ã | 20, 20, 10, 10 |

**–ó–∞–ø—É—Å–∫**:
```bash
python -m kmeans.main --experiment exp4_scaling_k
```

---

### –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 5: GPU –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

**–¶–µ–ª—å**: –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ GPU-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| N | 1,000,000 |
| D | 50 |
| K | 8 |
| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã | Nsight Compute |
| –ú–µ—Ç—Ä–∏–∫–∏ | Memory bandwidth utilization, Kernel occupancy, L1/L2 cache hit rate, Warp execution efficiency, T_transfer vs T_compute |
| –ü–æ–≤—Ç–æ—Ä—ã | 10 |

**–ó–∞–ø—É—Å–∫**:
```bash
python -m kmeans.main --experiment exp5_gpu_profile
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –≠—Ç–æ—Ç —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ GPU-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤—â–∏–∫–∞ Nsight Compute –∏ –≤–∫–ª—é—á–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö (H2D, D2H) –∏ –∏—Ö –¥–æ–ª—é –æ—Ç –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

---

## –£—Å–ª–æ–≤–∏—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

### –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

–í—Å–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–≤–æ–¥–∏—Ç—å—Å—è –Ω–∞ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

**–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è**:

**CPU**:
- –ú–æ–¥–µ–ª—å: 12th Gen Intel(R) Core(TM) i5-12600KF
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —è–¥–µ—Ä: 10
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö —è–¥–µ—Ä: 16
- –ë–∞–∑–æ–≤–∞—è/—É—Å–∫–æ—Ä–µ–Ω–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞: 3.7 –ì–ì—Ü / 4.9 –ì–ì—Ü
- –†–∞–∑–º–µ—Ä –∫—ç—à–∞ L1/L2/L3:
  - P-core: 80 –ö–ë/1280 –ö–ë –Ω–∞ —è–¥—Ä–æ
  - E-core: 96 –ö–ë/2 –ú–ë –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä
  - L3 (–æ–±—â–∏–π): 20 –ú–ë

**GPU**:
- –ú–æ–¥–µ–ª—å: NVIDIA GeForce RTX 3050
- Compute Capability: 8.6
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ SM: 20
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ CUDA-—è–¥–µ—Ä: 2560
- –û–±—ä—ë–º –≤–∏–¥–µ–æ–ø–∞–º—è—Ç–∏: 8 –ì–ë
- –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ø–∞–º—è—Ç–∏: 224 –ì–ë/—Å
- –í–µ—Ä—Å–∏—è –¥—Ä–∞–π–≤–µ—Ä–∞: 32.0.15.9144
- CUDA toolkit version: V13.1.80

**RAM**:
- –û–±—ä—ë–º: 32 –ì–ë
- –¢–∏–ø: DDR4
- –ß–∞—Å—Ç–æ—Ç–∞ (—Ä–µ–∞–ª—å–Ω–∞—è): 1333 –ú–ì—Ü
- –ß–∞—Å—Ç–æ—Ç–∞ (—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è): 2667 –ú–ì—Ü

### –ö—Ä–∏—Ç–µ—Ä–∏–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –µ–¥–∏–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏, —Ç–∞–∫ –∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏:

```
||Œº‚Çñ^(t+1) - Œº‚Çñ^t|| < Œµ, N_–∏—Ç–µ—Ä = 100
```

–í–≤–∏–¥—É —Ç–æ–≥–æ, —á—Ç–æ –∫—Ä–∏—Ç–µ—Ä–∏–π —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ —Ä–∞–∑–Ω–æ–º—É —á–∏—Å–ª—É –∏—Ç–µ—Ä–∞—Ü–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–æ—Ä—è–¥–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π, —Ç–æ—á–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–π —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π), —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –∫–∞–∂–¥–∞—è –∏–∑ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –æ–±—ä—ë–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

### –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏

–î–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —á–∞—Å—Ç–∏ (–±–µ–∑ –≤–≤–æ–¥–∞ –∏ –≤—ã–≤–æ–¥–∞) –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ —è–∑—ã–∫–æ–º –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π:

- **Python**: `time.perf_counter()`
- **C#**: `System.Diagnostics.Stopwatch`
- **C++**: `std::chrono::steady_clock`
- **CUDA**: `cudaEvent_t`

–í —Ä–∞–º–∫–∞—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ 3 –∏—Ç–µ—Ä–∞—Ü–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ (warm-up), –ø–æ—Å–ª–µ —á–µ–≥–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Å–Ω–æ–≤–Ω–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ: –∑–∞–¥–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤ –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Å —Ñ–∏–∫—Å–∞—Ü–∏–µ–π –≤—Ä–µ–º–µ–Ω–∏. –ó–∞—Ç–µ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.

### –û–ø–∏—Å–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö

–î–ª—è –≤—Å–µ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π –æ—Ü–µ–Ω–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö —Å —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤–∞—Ä—å–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∑–∞ —Å—á–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Scikit-learn —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º `random_state = 42` –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∞—Ä—å–∏—Ä–æ–≤–∞–Ω–∏—è**:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫: **N ‚àà {10¬≥, 10‚Åµ, 10‚Å∂, 5√ó10‚Å∂}**
- –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å: **D ‚àà {2, 10, 50, 100, 200}**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤: **K ‚àà {4, 8, 16, 32}**

**–ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** (–¥–ª—è —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤):
- **N = 100,000** —Ç–æ—á–µ–∫
- **D = 50** –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- **K = 8** –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è —Å –≤–∞—Ä—å–∏—Ä–æ–≤–∞–Ω–∏–µ–º –æ–¥–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø—Ä–∏ —Ñ–∏–∫—Å–∞—Ü–∏–∏ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –Ω–∞ –±–∞–∑–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö.

---

## –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞

### CPU NumPy (–û–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–∞—è)

–ë–∞–∑–æ–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ NumPy –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```python
from kmeans.core.cpu_numpy import KMeansCPUNumpy

model = KMeansCPUNumpy(n_clusters=8, n_iters=100, tol=1e-6)
model.fit(X, initial_centroids)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ü—Ä—è–º–æ–ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —è—Å–Ω–æ—Å—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ NumPy
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –∏ —Å—Ä–µ–¥–Ω–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ–¥–Ω–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏: O(N √ó K √ó D)
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (tol=1e-6) –∏–ª–∏ –º–∞–∫—Å–∏–º—É–º 100 –∏—Ç–µ—Ä–∞—Ü–∏–π

---

### CPU Multiprocessing (–ú–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–Ω–∞—è)

–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `multiprocessing.Pool` –∏ —Ä–∞–∑–¥–µ–ª—è–µ–º–æ–π –ø–∞–º—è—Ç–∏.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```python
from kmeans.core.cpu_multiprocessing import (
    KMeansCPUMultiprocessing,
    MultiprocessingConfig
)

config = MultiprocessingConfig(n_processes=4)
model = KMeansCPUMultiprocessing(n_clusters=8, mp=config)
model.fit(X, initial_centroids)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- **–†–∞–∑–¥–µ–ª—è–µ–º–∞—è –ø–∞–º—è—Ç—å** –¥–ª—è –¥–∞–Ω–Ω—ã—Ö (RawArray) ‚Äî –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–∞—Ü–∏—è —à–∞–≥–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è** –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –ø–æ —á–∞–Ω–∫–∞–º –æ–±—ä–µ–∫—Ç–æ–≤
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–µ–¥—É–∫—Ü–∏—è** –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤
- **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—É–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤** –º–µ–∂–¥—É –∏—Ç–µ—Ä–∞—Ü–∏—è–º–∏
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –º–Ω–æ–≥–æ—è–¥–µ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (tol=1e-6) –∏–ª–∏ –º–∞–∫—Å–∏–º—É–º 100 –∏—Ç–µ—Ä–∞—Ü–∏–π

---

### GPU CuPy (CUDA)

–ù–µ—Å–∫–æ–ª—å–∫–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö GPU-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –Ω–∞ CuPy.

#### –í–µ—Ä—Å–∏—è V1 (`KMeansGPUCuPyV1`) - –ë–∞–∑–æ–≤–∞—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```python
from kmeans.core.gpu_numpy import KMeansGPUCuPyV1

model = KMeansGPUCuPyV1(n_clusters=8)
model.fit(X, initial_centroids)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –ü—Ä—è–º–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π —á–µ—Ä–µ–∑ broadcasting
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `einsum` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –ü–µ—Ä–µ–Ω–æ—Å –¥–∞–Ω–Ω—ã—Ö –Ω–∞ GPU –æ–¥–∏–Ω —Ä–∞–∑
- –ü–∞–º—è—Ç—å: O(N √ó K √ó D) –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ diff
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (tol=1e-6) –∏–ª–∏ –º–∞–∫—Å–∏–º—É–º 100 –∏—Ç–µ—Ä–∞—Ü–∏–π

#### –í–µ—Ä—Å–∏—è V2 (`KMeansGPUCuPyV2`) - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```python
from kmeans.core.gpu_numpy import KMeansGPUCuPyV2

model = KMeansGPUCuPyV2(n_clusters=8)
model.fit(X, initial_centroids)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –±–µ–∑ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ–Ω–∑–æ—Ä–∞ `diff`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º—É–ª—ã: `||x - c||¬≤ = ||x||¬≤ + ||c||¬≤ - 2x¬∑c`
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Ä–µ–¥—É–∫—Ü–∏—è —á–µ—Ä–µ–∑ `scatter_add` (cp.add.at) –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤
- –ü–∞–º—è—Ç—å: O(N √ó K) –≤–º–µ—Å—Ç–æ O(N √ó K √ó D)
- –ë—ã—Å—Ç—Ä–µ–µ V1 –∑–∞ —Å—á–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ assign –∏ update

#### –í–µ—Ä—Å–∏—è V3 (`KMeansGPUCuPyV3`) - –ë—ã—Å—Ç—Ä–∞—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```python
from kmeans.core.gpu_numpy import KMeansGPUCuPyV3

model = KMeansGPUCuPyV3(n_clusters=8)
model.fit(X, initial_centroids)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- –¢–∞ –∂–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –¥–ª—è assign, —á—Ç–æ –∏ –≤ V2
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä–µ–¥—É–∫—Ü–∏—è —á–µ—Ä–µ–∑ `scatter_add`
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `float32` –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–º–µ–Ω—å—à–µ —Ç—Ä–∞—Ñ–∏–∫ –∏ –ø–∞–º—è—Ç—å)
- –ë—ã—Å—Ç—Ä–µ–µ V2 –∑–∞ —Å—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è float32

#### –í–µ—Ä—Å–∏—è V4 (`KMeansGPUCuPyV4`) - –°–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**:
```python
from kmeans.core.gpu_numpy import KMeansGPUCuPyV4

model = KMeansGPUCuPyV4(n_clusters=8)
model.fit(X, initial_centroids)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- Raw CUDA kernel –¥–ª—è —à–∞–≥–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ —Å —Ä—É—á–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
- Raw CUDA kernel –¥–ª—è —à–∞–≥–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤ —Å –∞—Ç–æ–º–∞—Ä–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `float32`
- –ë—ã—Å—Ç—Ä–µ–µ V3 –∑–∞ —Å—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è raw CUDA kernels

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –î–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —Å—Ç–∞—Ä—ã–µ –∏–º–µ–Ω–∞:
- `KMeansGPUCuPy` (–∞–ª–∏–∞—Å –¥–ª—è V1)
- `KMeansGPUCuPyBincount` (–∞–ª–∏–∞—Å –¥–ª—è V2)
- `KMeansGPUCuPyFast` (–∞–ª–∏–∞—Å –¥–ª—è V3)
- `KMeansGPUCuPyRaw` (–∞–ª–∏–∞—Å –¥–ª—è V4)

---

## –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–î–ª—è –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|------------------------|----------|
| `T_assign` | `T_–Ω–∞–∑–Ω` | –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∞–≥–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è: –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –Ω–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –æ—Ç –≤—Å–µ—Ö —Ç–æ—á–µ–∫ –¥–æ –≤—Å–µ—Ö —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞ (–Ω–∞ –æ–¥–Ω—É –∏—Ç–µ—Ä–∞—Ü–∏—é, –º—Å) |
| `T_update` | `T_–æ–±–Ω` | –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∞–≥–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤: –ø–µ—Ä–µ—Å—á–µ—Ç —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É—é—â–∏–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–µ–¥—É–∫—Ü–∏–∏ (–Ω–∞ –æ–¥–Ω—É –∏—Ç–µ—Ä–∞—Ü–∏—é, –º—Å) |
| `T_iter` | `T_–∏—Ç–µ—Ä` | –ü–æ–ª–Ω–æ–µ –≤—Ä–µ–º—è –æ–¥–Ω–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞: `T_–∏—Ç–µ—Ä = T_–Ω–∞–∑–Ω + T_–æ–±–Ω` (–º—Å) |
| `T_total` | `T_–æ–±—â` | –û–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏: `T_–æ–±—â = Œ£(t=1 to N_–∏—Ç–µ—Ä) T_–∏—Ç–µ—Ä^(t)` (–º—Å) |

### –ú–µ—Ç—Ä–∏–∫–∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –§–æ—Ä–º—É–ª–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|----------|
| **Speedup (S)** | `S = T_–æ–ø—Ä / T_–º–ø—Ä` | –£—Å–∫–æ—Ä–µ–Ω–∏–µ: –≥–¥–µ `T_–æ–ø—Ä` ‚Äî –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –∞ `T_–º–ø—Ä` ‚Äî –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ |
| **Parallel Efficiency (E)** | `E = S / p` | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: –≥–¥–µ `p` ‚Äî —á–∏—Å–ª–æ –ø–æ—Ç–æ–∫–æ–≤ (CPU) –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤ (GPU) |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –î–ª—è GPU —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π `p = 1`, –ø–æ—ç—Ç–æ–º—É –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ Speedup –±–µ–∑ Efficiency.

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –§–æ—Ä–º—É–ª–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|----------|
| **Throughput (–ü–°)** | `–ü–° = (N √ó K √ó D √ó N_–∏—Ç–µ—Ä) / T_–æ–±—â` | –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (–æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Å–µ–∫—É–Ω–¥—É) |

### –ú–µ—Ç—Ä–∏–∫–∏ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö (GPU)

| –ú–µ—Ç—Ä–∏–∫–∞ | –§–æ—Ä–º—É–ª–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|---------|----------|
| `T_transfer` | `T_–ø–µ—Ä = T_H2D + T_D2H` | –í—Ä–µ–º—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö: –æ–±—â–µ–µ –≤—Ä–µ–º—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É CPU –∏ GPU |
| `R_transfer` | `R_–ø–µ—Ä = (T_–ø–µ—Ä / T_–æ–±—â) √ó 100%` | –î–æ–ª—è –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö: –ø—Ä–æ—Ü–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –æ—Ç –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è |

**–ì–¥–µ**:
- `T_H2D`: –≤—Ä–µ–º—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö —Å CPU –Ω–∞ GPU (Host-to-Device)
- `T_D2H`: –≤—Ä–µ–º—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö —Å GPU –Ω–∞ CPU (Device-to-Host)

---

## –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –§–æ—Ä–º–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ **NDJSON** (–∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π JSON-–æ–±—ä–µ–∫—Ç) –≤ —Ñ–∞–π–ª `kmeans_timing_results.json`:

```json
{
  "experiment": "exp2_scaling_n",
  "implementation": "python_cpu_numpy",
  "threads": null,
  "dataset": {
    "N": 100000,
    "D": 50,
    "K": 8,
    "purpose": "scaling_by_N"
  },
  "timing": {
    "T_fit_avg": 20.226,
    "T_fit_med": 20.145,
    "T_assign_total_avg": 18.056,
    "T_update_total_avg": 2.165,
    "T_iter_total_avg": 20.221,
    "speedup": 1.0,
    "efficiency": 1.0,
    "throughput_ops_avg": 197500000.0,
    "T_transfer_avg": null,
    "T_transfer_ratio_avg": null,
    "runs": [...]
  }
}
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑

–ú–æ–¥—É–ª—å `analyze_timings.py` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:

```python
from scripts.analyze_timings import compute_stats_from_results, TimingResultsAnalyzer

# –ü—Ä–æ—Å—Ç–æ–π –∞–Ω–∞–ª–∏–∑ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ —Ñ–∞–π–ª
compute_stats_from_results(
    "kmeans_timing_results.json",
    n_iters=100,
    output_path="timings_report.txt"
)

# –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑
analyzer = TimingResultsAnalyzer("kmeans_timing_results.json", n_iters=100)
analyzer.analyze(output_path="timings_report.txt")
```

**–í—ã–≤–æ–¥ –≤–∫–ª—é—á–∞–µ—Ç**:
- –°—Ä–µ–¥–Ω–∏–µ –∏ –º–µ–¥–∏–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (–Ω–∞ –æ–¥–Ω—É –∏—Ç–µ—Ä–∞—Ü–∏—é)
- –°—Ä–µ–¥–Ω–∏–µ –∏ –º–µ–¥–∏–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤ (–Ω–∞ –æ–¥–Ω—É –∏—Ç–µ—Ä–∞—Ü–∏—é)
- –°—Ä–µ–¥–Ω–∏–µ –∏ –º–µ–¥–∏–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ–¥–Ω–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
- –°—Ä–µ–¥–Ω–∏–µ –∏ –º–µ–¥–∏–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–ª–≥–æ—Ä–∏—Ç–º–∞

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
parallel/
‚îú‚îÄ‚îÄ main.py                      # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ scripts/                     # –£—Ç–∏–ª–∏—Ç—ã –∏ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ generate_datasets.py     # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ vizualize_datasets.py    # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ analyze_timings.py       # –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ analyze_gpu_results.py   # –ê–Ω–∞–ª–∏–∑ GPU —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ calculate_metrics_from_summary.py  # –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚îÇ
‚îú‚îÄ‚îÄ datasets/                     # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ base/                    # –ë–∞–∑–æ–≤—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ scaling_N/               # –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ N
‚îÇ   ‚îú‚îÄ‚îÄ scaling_D/               # –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ D
‚îÇ   ‚îú‚îÄ‚îÄ scaling_K/               # –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ K
‚îÇ   ‚îú‚îÄ‚îÄ validation/              # –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ datasets_summary.json    # –°–≤–æ–¥–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ kmeans/                      # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–∫–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ main.py                  # CLI –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ core/                    # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py              # –ë–∞–∑–æ–≤—ã–π –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π –∫–ª–∞—Å—Å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cpu_numpy.py         # –û–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–∞—è CPU —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cpu_multiprocessing.py  # –ú–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–Ω–∞—è CPU —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gpu_numpy.py         # GPU —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (CuPy/CUDA)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ data/                    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dataset.py           # –ö–ª–∞—Å—Å Dataset
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ registry.py          # –†–µ–µ—Å—Ç—Ä –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validation.py        # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ experiments/             # –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ runner.py            # –ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ suite.py             # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ metrics/                 # –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metrics.py           # –£—Å–∫–æ—Ä–µ–Ω–∏–µ, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ timers.py            # –í—ã—Å–æ–∫–æ—Ç–æ—á–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ utils/                   # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ       ‚îî‚îÄ‚îÄ logging.py           # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ kmeans_timing_results.json  # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ (NDJSON)
‚îú‚îÄ‚îÄ visualizations/              # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ tests/                       # –¢–µ—Å—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ conftest.py             # –§–∏–∫—Å—Ç—É—Ä—ã —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ test_core/               # –¢–µ—Å—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_cpu_numpy.py   # Unit-—Ç–µ—Å—Ç—ã CPU —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ test_consistency.py # –¢–µ—Å—Ç—ã —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ test_metrics/            # –¢–µ—Å—Ç—ã –º–µ—Ç—Ä–∏–∫ –∏ —Ç–∞–π–º–µ—Ä–æ–≤
‚îÇ
‚îú‚îÄ‚îÄ requirements.txt             # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ README.md                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```

---

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞

1. –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å, –Ω–∞—Å–ª–µ–¥—É—é—â–∏–π `KMeansBase`:

```python
from kmeans.core.base import KMeansBase
import numpy as np

class MyKMeans(KMeansBase):
    """
    –û–ø–∏—Å–∞–Ω–∏–µ –≤–∞—à–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
    """
    
    def assign_clusters(
        self, X: np.ndarray, centroids: np.ndarray
    ) -> np.ndarray:
        """
        –®–∞–≥ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ç–æ—á–µ–∫ –∫–ª–∞—Å—Ç–µ—Ä–∞–º.
        
        Args:
            X: –ú–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö (N, D)
            centroids: –¢–µ–∫—É—â–∏–µ —Ü–µ–Ω—Ç—Ä–æ–∏–¥—ã (K, D)
            
        Returns:
            –ú–µ—Ç–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (N,)
        """
        # –í–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —à–∞–≥–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
        pass
    
    def update_centroids(
        self, X: np.ndarray, labels: np.ndarray
    ) -> np.ndarray:
        """
        –®–∞–≥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤.
        
        Args:
            X: –ú–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö (N, D)
            labels: –ú–µ—Ç–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (N,)
            
        Returns:
            –ù–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä–æ–∏–¥—ã (K, D)
        """
        # –í–∞—à–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —à–∞–≥–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        pass
```

2. –î–æ–±–∞–≤—å—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç –≤ `kmeans/core/__init__.py`:

```python
from .my_kmeans import MyKMeans

__all__ = [..., "MyKMeans"]
```

3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö —á–µ—Ä–µ–∑ —Ñ–∞–±—Ä–∏–∫—É:

```python
def _my_implementation_factory(**kw):
    return MyKMeans(n_clusters=kw['n_clusters'], logger=kw.get('logger'))
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

1. –î–æ–±–∞–≤—å—Ç–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤ `kmeans/experiments/config.py`:

```python
class ExperimentId(str, Enum):
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
    MY_EXPERIMENT = "exp6_my_experiment"
```

2. –î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```python
EXPERIMENTS: Dict[ExperimentId, ExperimentConfig] = {
    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    ExperimentId.MY_EXPERIMENT: ExperimentConfig(
        id=ExperimentId.MY_EXPERIMENT,
        description="–û–ø–∏—Å–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞",
        implementations=["my_impl"],
        params={
            "N": 100000,
            "D": 50,
            "K": 8,
            "repeats": 20,
        },
    ),
}
```

3. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ –≤ `ExperimentSuite`:

```python
def run_exp6_my_experiment(self) -> List[dict]:
    """
    –û–ø–∏—Å–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞.
    
    Returns:
        –°–ø–∏—Å–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
    """
    cfg = EXPERIMENTS[ExperimentId.MY_EXPERIMENT]
    # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
    results: List[dict] = []
    # ...
    return results
```

4. –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ `kmeans/main.py`:

```python
elif args.experiment == ExperimentId.MY_EXPERIMENT.value:
    suite = make_suite_single()
    results = suite.run_exp6_my_experiment()
```

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã –≤—Å–µ—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º–∞.

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –í—Å–µ —Ç–µ—Å—Ç—ã
pytest tests/

# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏)
pytest tests/test_core/test_consistency.py -v

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
pytest tests/ --cov=kmeans --cov-report=html

# –¢–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã (–±–µ–∑ GPU)
pytest tests/ -m "not gpu"
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

- **–¢–µ—Å—Ç—ã —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏** (`test_consistency.py`) ‚Äî –ø—Ä–æ–≤–µ—Ä—è—é—Ç, —á—Ç–æ –≤—Å–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –±–µ–Ω—á–º–∞—Ä–∫–æ–≤.
- **Unit-—Ç–µ—Å—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π** (`test_cpu_numpy.py`) ‚Äî –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∞–ª–≥–æ—Ä–∏—Ç–º–∞.
- **–¢–µ—Å—Ç—ã –º–µ—Ç—Ä–∏–∫** (`test_metrics/`) ‚Äî –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

### –ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è

1. **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π** ‚Äî CPU NumPy, CPU Multiprocessing, GPU CuPy –∏ GPU CuPy Fast –¥–æ–ª–∂–Ω—ã –¥–∞–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä–æ–∏–¥—ã –Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
2. **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —à–∞–≥–æ–≤ `assign_clusters` –∏ `update_centroids`, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.
3. **–ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è speedup, efficiency, throughput.

---

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: CuPy –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ**:
- CuPy —Ç—Ä–µ–±—É–µ—Ç CUDA Toolkit. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∞–π—Ç–∞ NVIDIA
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é: `cupy-cuda12x` –¥–ª—è CUDA 12.x, `cupy-cuda11x` –¥–ª—è CUDA 11.x
- GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ ‚Äî –ø—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –±–µ–∑ –Ω–µ—ë

### –ü—Ä–æ–±–ª–µ–º–∞: OutOfMemoryError –Ω–∞ GPU

**–†–µ—à–µ–Ω–∏–µ**:
- –î–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ (N ‚â• 1,000,000) —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ GPU-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, —É–º–µ–Ω—å—à–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CPU-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞: PyCharm –Ω–µ –≤–∏–¥–∏—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ**:
1. **File** ‚Üí **Settings** ‚Üí **Project: parallel** ‚Üí **Python Interpreter**
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —à–µ—Å—Ç–µ—Ä—ë–Ω–∫—É ‚Üí **"Add..."**
3. –í—ã–±–µ—Ä–∏—Ç–µ **"Existing environment"**
4. –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ `python.exe` –≤ `.venv\Scripts\python.exe` (Windows) –∏–ª–∏ `.venv/bin/python` (Linux/macOS)

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–†–µ—à–µ–Ω–∏–µ**:
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Python 3.10 –∏–ª–∏ –≤—ã—à–µ
- –û–±–Ω–æ–≤–∏—Ç–µ pip: `python -m pip install --upgrade pip`
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–æ –æ–¥–Ω–æ–π –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:

```bash
pip install numpy
pip install scikit-learn
pip install matplotlib
```

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è NumPy](https://numpy.org/doc/)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è CuPy](https://docs.cupy.dev/)
- [–ê–ª–≥–æ—Ä–∏—Ç–º K-means (Wikipedia)](https://en.wikipedia.org/wiki/K-means_clustering)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è pytest](https://docs.pytest.org/)

---

## –ê–≤—Ç–æ—Ä—ã

–û-21-–ò–ê–°-–∞–∏–¥-–°
–ï—Ä–µ–º–∏–Ω –ò. –ê.
–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ K-means –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.

---

**–í–µ—Ä—Å–∏—è**: 1.0.1  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –î–µ–∫–∞–±—Ä—å 2024
